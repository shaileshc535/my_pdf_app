(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{437:function(e,t,n){"use strict";n.r(t),n.d(t,"ReviewFileViewer",(function(){return P})),n.d(t,"states",(function(){return N}));var r=n(0),a=n.n(r),o=n(455),i=n(450),l=n(451),c=n(44),u=n(498),s=n.n(u),f=n(56),p=n(81),d=n(452),m=n(448),b=n(454),h=n(458),v=n(569),y=function(){return(y=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},w=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function l(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}c((r=r.apply(e,t||[])).next())}))},g=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},E=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},O=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return i};function x(e){var t=this,n=e.open,u=e.fileId,s=E(e,["open","fileId"]),p=O(Object(r.useState)(""),2),x=p[0],S=p[1],j=O(Object(r.useState)(!1),2),I=(j[0],j[1]),k=function(){s.onClose(null,null)};return a.a.createElement(d.a,y({open:n,maxWidth:"xs",fullWidth:!0},s),a.a.createElement(o.a,{container:!0,alignItems:"center"},a.a.createElement(o.a,{item:!0,xs:!0},a.a.createElement(i.a,{variant:"h6",className:"p-3 font-weight-bold"},"PDF file review fail")),a.a.createElement(m.a,{onClick:k},a.a.createElement(v.a,null))),a.a.createElement(b.a,null),a.a.createElement(o.a,{className:"p-3"},a.a.createElement(h.a,{fullWidth:!0,size:"small",variant:"outlined",color:"primary",label:"Reason for review fail",value:x,onChange:function(e){return S(e.target.value)}})),a.a.createElement(b.a,null),a.a.createElement(o.a,{container:!0,alignItems:"center",justifyContent:"flex-end",className:"p-2-all"},a.a.createElement(o.a,{className:"pr-3"},a.a.createElement(l.a,{size:"small",variant:"contained",color:"primary",onClick:function(){return w(t,void 0,void 0,(function(){return g(this,(function(e){switch(e.label){case 0:return e.trys.push([0,,2,3]),I(!0),[4,f.a.put("file/review-file",{fileId:u,isReviewd:!1,fail_reason:x})];case 1:return e.sent(),[3,3];case 2:return I(!1),c.a.go("files"),k(),[7];case 3:return[2]}}))}))}},"Submit"))))}var S=n(7),j=n.n(S),I=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function l(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}c((r=r.apply(e,t||[])).next())}))},k=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},C=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return i};function P(){var e=this,t=Object(r.useRef)(null),n=Object(p.b)(),u=C(Object(r.useState)(null),2),d=u[0],m=u[1],b=C(Object(r.useState)(""),2),h=b[0],v=b[1],y=C(Object(r.useState)(null),2),w=y[0],g=y[1],E=C(Object(r.useState)(!1),2),O=E[0],S=E[1],P=C(Object(r.useState)(!1),2),N=P[0],H=P[1],A=c.a.params.fileId;return Object(r.useEffect)((function(){I(e,void 0,void 0,(function(){var e;return k(this,(function(r){switch(r.label){case 0:return r.trys.push([0,,2,3]),S(!0),[4,f.a.get("files/file/"+A)];case 1:return e=r.sent().data,m(e),s()({path:"pdf-tron",initialDoc:e[0].fileId.file_url},t.current).then((function(e){g(e);var t=e.Core,r=t.Annotations,a=t.annotationManager,o=t.documentViewer;e.UI.setHeaderItems((function(e){e.update([]);var t=e.getHeader("toolbarGroup-Annotate").get("toolsOverlay");e.getHeader("default").push({type:"toolGroupButton",toolGroup:"signatureTools",dataElement:"signatureToolGroupButton",title:"annotation.signature"}),e.push(t)})),e.UI.disableElements(["ribbons"]),e.UI.disableElements(["toolsHeader"]),o.addEventListener("annotationsLoaded",(function(){var e=new r.StampAnnotation({X:10,Y:o.getPageHeight(1)-60,Opacity:.4,Width:300,Height:50});e.setStampText(n._id+" / "+j()().format("MMM DD, YYYY HH:mm:ss")),a.addAnnotation(e),a.redrawAnnotation(e)}))})),[3,3];case 2:return S(!1),[7];case 3:return[2]}}))}))}),[]),Object(r.useEffect)((function(){v(null==d?void 0:d.docname)}),[d]),a.a.createElement(o.a,{item:!0,xs:!0,container:!0,direction:"column",wrap:"nowrap"},a.a.createElement(o.a,{container:!0,alignItems:"center",className:"p-2 bg-white"},a.a.createElement(i.a,{variant:"h6",component:o.a,item:!0,xs:!0,className:"p-2 font-weight-bold"},h),a.a.createElement(l.a,{disabled:O,variant:"contained",color:"primary",className:"mr-2",onClick:function(){return I(e,void 0,void 0,(function(){var e,t,n,r,a,o;return k(this,(function(i){switch(i.label){case 0:return i.trys.push([0,,4,5]),S(!0),e=w.docViewer,t=w.annotManager,n=e.getDocument(),[4,t.exportAnnotations({widgets:!0,fields:!0})];case 1:return r=i.sent(),[4,n.getFileData({xfdfString:r})];case 2:return a=i.sent(),o=new Uint8Array(a),new Blob([o],{type:"application/pdf"}),[4,f.a.put("file/review-file",{fileId:A,isReviewd:!0,fail_reason:""})];case 3:return i.sent(),[3,5];case 4:return S(!1),c.a.go("files"),[7];case 5:return[2]}}))}))}},"Pass"),a.a.createElement(l.a,{disabled:O,variant:"contained",color:"secondary",className:"ml-2 mr-2",onClick:function(){return I(e,void 0,void 0,(function(){return k(this,(function(e){switch(e.label){case 0:return[4,w.downloadPdf()];case 1:return[2,e.sent()]}}))}))}},"Download"),a.a.createElement(l.a,{disabled:O,variant:"contained",color:"primary",className:"ml-2 mr-2",onClick:function(){H(!0)}},"Fail")),a.a.createElement(o.a,{item:!0,xs:!0,ref:t}),a.a.createElement(x,{fileId:A,open:N,onClose:function(){return H(!1)}}))}var N=[{url:"/review-file-viewer?:fileId",name:"reviewFileViewer",data:{title:"File Viewer",loggedIn:!0},component:P}]}}]);